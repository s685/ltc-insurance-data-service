-- LTC Insurance Platform - Sample Data Insertion Script
-- Inserts 4 sample records for each table with realistic data

USE DATABASE LTC_INSURANCE;
USE SCHEMA ANALYTICS;

-- ============================================================================
-- Insert Sample Policy Data
-- ============================================================================

INSERT INTO POLICY_MONTHLY_SNAPSHOT_FACT VALUES (
    'POL-SNAP-001',  -- POLICY_MONTHLY_SNAPSHOT_ID
    'POL-DIM-001',  -- POLICY_DIM_ID
    100001,  -- POLICY_ID
    'LIFE-001',  -- INSURED_LIFE_DIM_ID
    50001,  -- INSURED_LIFE_ID
    'Springfield',  -- INSURED_CITY
    'IL',  -- INSURED_STATE
    '62701',  -- INSURED_ZIP
    'IL',  -- POLICY_RESIDENCE_STATE
    'PAF-001',  -- PAF_RELATIONSHIP_DIM_ID
    'MEM-001',  -- MEMBER_LIFE_DIM_ID
    60001,  -- MEMBER_LIFE_ID
    'GRP-001',  -- GRP_DIM_ID
    3500.00,  -- ANNUALIZED_PREMIUM
    42000.00,  -- LIFETIME_COLLECTED_PREMIUM
    0.00,  -- LIFETIME_WAIVER_PREMIUM
    'Annual',  -- PREMIUM_FREQUENCY
    0.00,  -- OFFSET_PREMIUM
    'ACTIVE',  -- POLICY_STATUS_DIM_ID
    1001,  -- CURRENT_COVERAGE_ID
    'COV-001',  -- CURRENT_COVERAGE_DIM_ID
    '20210101',  -- ORIGINAL_EFFECTIVE_DT_ID
    '2021-01-15 00:00:00.000',  -- ORIGINAL_EFFECTIVE_DT
    '20210101',  -- COVERAGE_EFFECTIVE_DT_ID
    '2021-01-15 00:00:00.000',  -- COVERAGE_EFFECTIVE_DT
    '20210101',  -- COVERAGE_STATUS_DT_ID
    '2021-01-15 00:00:00.000',  -- COVERAGE_STATUS_DT
    NULL,  -- COVERAGE_EXPIRATION_DT_ID
    NULL,  -- COVERAGE_EXPIRATION_DT
    NULL,  -- POLICY_EXPIRATION_DT_ID
    NULL,  -- POLICY_EXPIRATION_DT (NULL = Active)
    '20201220',  -- APPN_RCV_DT_ID
    '2020-12-20 00:00:00.000',  -- APPN_RCV_DT
    '20201215',  -- APPN_SIG_DT_ID
    '2020-12-15 00:00:00.000',  -- APPN_SIG_DT
    'IL',  -- APPN_SIG_STATE
    NULL, NULL, NULL, NULL,  -- WAIVER dates
    'No',  -- IN_WAIVER_FLG
    'Not in waiver status',  -- IN_WAIVER_DESC
    NULL, NULL, NULL, NULL,  -- NONFORFEITURE dates
    'No',  -- IN_NONFORFEITURE_FLG
    'Not in nonforfeiture',  -- IN_NONFORFEITURE_DESC
    NULL, NULL, NULL, NULL,  -- SURVIVORSHIP dates
    'No',  -- SURVIVORSHIP_FLG
    'No survivorship',  -- SURVIVORSHIP_DESC
    '20241001',  -- PAID_TO_DATE_ID
    '2024-10-01 00:00:00.000',  -- PAID_TO_DATE
    'CLM-001',  -- LATEST_CLAIM_DIM_ID
    2001,  -- LATEST_CLAIM_ID
    72,  -- RATED_AGE
    '2021-01-10 00:00:00.000',  -- RATED_DATE
    'TAX-QUAL-001',  -- TAX_QUALIFICATION_DIM_ID
    '3% Compound',  -- BENEFIT_INFLATION
    'Annual',  -- BENEFIT_INCREASE
    '2023-06-15 00:00:00.000',  -- FIRST_EOB_DECISION_DT
    '20230615',  -- FIRST_EOB_DECISION_DT_ID
    '2024-01-10 00:00:00.000',  -- LATEST_EOB_DECISION_DT
    '20240110',  -- LATEST_EOB_DECISION_DT_ID
    '2023-05-20 00:00:00.000',  -- LATEST_CLAIM_INCURRED_DT
    '20230520',  -- LATEST_CLAIM_INCURRED_DT_ID
    NULL,  -- LATEST_CLAIM_EXPIRATION_DT
    NULL,  -- LATEST_CLAIM_EXPIRATION_DT_ID
    'ACTIVE',  -- CLAIM_STATUS_CD
    'F',  -- CLAIMANT_SEX
    '2024-02-01 00:00:00.000',  -- CLAIM_PAID_DT
    '20240201',  -- CLAIM_PAID_DT_ID
    125000.00,  -- TOTAL_REQUEST_FOR_REIMBURSMENT_BENEFIT
    2500.00,  -- TOTAL_REQUEST_FOR_REIMBURSMENT_ADMIN
    5000.00,  -- TOTAL_REQUEST_FOR_REIMBURSMENT_PENDING
    132500.00,  -- TOTAL_REQUEST_FOR_REIMBURSMENT_REQUESTED_AMOUNT
    10000.00,  -- TOTAL_REQUEST_FOR_REIMBURSMENT_UNPAID_AMOUNT
    'ICD-001',  -- DISABLING_EVENT_ICD_DIM_ID
    'ICD-002',  -- PRIMARY_DIAGNOSIS_ICD_DIM_ID
    2,  -- TOTAL_ACTIVE_CLAIMS
    15,  -- TOTAL_RFBS
    12,  -- TOTAL_APPROVED_RFBS
    2,  -- TOTAL_DENIALS
    'Acme Insurance Co',  -- CARRIER_NAME
    'PROD',  -- ENVIRONMENT
    '2024-10-31'  -- POLICY_SNAPSHOT_DATE
);

INSERT INTO POLICY_MONTHLY_SNAPSHOT_FACT VALUES (
    'POL-SNAP-002', 'POL-DIM-002', 100002, 'LIFE-002', 50002,
    'Austin', 'TX', '73301', 'TX', 'PAF-002', 'MEM-002', 60002, 'GRP-002',
    4200.00, 25200.00, 8400.00, 'Annual', 0.00, 'WAIVER', 1002, 'COV-002',
    '20190301', '2019-03-01 00:00:00.000', '20190301', '2019-03-01 00:00:00.000',
    '20190301', '2019-03-01 00:00:00.000', NULL, NULL, NULL, NULL,
    '20190301', '2019-03-01 00:00:00.000', '20190215', '2019-02-15 00:00:00.000', 'TX',
    '20230801', '2023-08-01 00:00:00.000', NULL, NULL,
    'Yes', 'Currently in waiver', 
    NULL, NULL, NULL, NULL, 'No', 'Not in nonforfeiture',
    NULL, NULL, NULL, NULL, 'No', 'No survivorship',
    '20241001', '2024-10-01 00:00:00.000', 'CLM-002', 2002,
    68, '2019-02-25 00:00:00.000', 'TAX-QUAL-002', '5% Simple', 'Annual',
    '2023-09-10 00:00:00.000', '20230910', '2024-03-15 00:00:00.000', '20240315',
    '2023-08-01 00:00:00.000', '20230801', NULL, NULL,
    'APPROVED', 'M', '2024-04-01 00:00:00.000', '20240401',
    85000.00, 1800.00, 0.00, 86800.00, 0.00,
    'ICD-003', 'ICD-004', 1, 8, 8, 0,
    'Beta Health Insurance', 'PROD', '2024-10-31'
);

INSERT INTO POLICY_MONTHLY_SNAPSHOT_FACT VALUES (
    'POL-SNAP-003', 'POL-DIM-003', 100003, 'LIFE-003', 50003,
    'Seattle', 'WA', '98101', 'WA', 'PAF-003', 'MEM-003', 60003, 'GRP-003',
    5500.00, 110000.00, 0.00, 'Annual', 0.00, 'ACTIVE', 1003, 'COV-003',
    '20150601', '2015-06-01 00:00:00.000', '20150601', '2015-06-01 00:00:00.000',
    '20150601', '2015-06-01 00:00:00.000', NULL, NULL, NULL, NULL,
    '20150520', '2015-05-20 00:00:00.000', '20150515', '2015-05-15 00:00:00.000', 'WA',
    NULL, NULL, NULL, NULL, 'No', 'Not in waiver status',
    NULL, NULL, NULL, NULL, 'No', 'Not in nonforfeiture',
    NULL, NULL, NULL, NULL, 'No', 'No survivorship',
    '20241001', '2024-10-01 00:00:00.000', NULL, NULL,
    75, '2015-05-18 00:00:00.000', 'TAX-QUAL-003', '3% Compound', 'Annual',
    NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
    NULL, NULL, NULL, NULL,
    0.00, 0.00, 0.00, 0.00, 0.00,
    NULL, NULL, 0, 0, 0, 0,
    'Acme Insurance Co', 'PROD', '2024-10-31'
);

INSERT INTO POLICY_MONTHLY_SNAPSHOT_FACT VALUES (
    'POL-SNAP-004', 'POL-DIM-004', 100004, 'LIFE-004', 50004,
    'Miami', 'FL', '33101', 'FL', 'PAF-004', 'MEM-004', 60004, 'GRP-004',
    2800.00, 33600.00, 0.00, 'Annual', 0.00, 'LAPSED', 1004, 'COV-004',
    '20180901', '2018-09-01 00:00:00.000', '20180901', '2018-09-01 00:00:00.000',
    '20180901', '2018-09-01 00:00:00.000', '20230228', '2023-02-28 00:00:00.000',
    NULL, '2023-02-28 00:00:00.000',
    '20180815', '2018-08-15 00:00:00.000', '20180810', '2018-08-10 00:00:00.000', 'FL',
    NULL, NULL, NULL, NULL, 'No', 'Not in waiver status',
    '20230301', '2023-03-01 00:00:00.000', NULL, NULL,
    'Yes', 'In nonforfeiture status',
    NULL, NULL, NULL, NULL, 'No', 'No survivorship',
    '20230201', '2023-02-01 00:00:00.000', NULL, NULL,
    65, '2018-08-12 00:00:00.000', 'TAX-QUAL-004', 'No Inflation', 'None',
    NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
    NULL, NULL, NULL, NULL,
    0.00, 0.00, 0.00, 0.00, 0.00,
    NULL, NULL, 0, 0, 0, 0,
    'Gamma Long Term Care', 'PROD', '2024-10-31'
);

-- ============================================================================
-- Insert Sample Claims Data
-- ============================================================================

INSERT INTO CLAIMS_TPA_FEE_WORKSHEET_SNAPSHOT_FACT VALUES (
    'CLM-WS-001',  -- TPA_FEE_WORKSHEET_SNAPSHOT_FACT_ID
    'POL-DIM-001',  -- POLICY_DIM_ID
    'John Smith',  -- CLAIMANTNAME
    'POL-100001',  -- POLICY_NUMBER
    'Approved',  -- DECISION
    '2024-01-01',  -- LATEST_EOB_START_DT
    '2024-03-31',  -- LATEST_EOB_END_DT
    '2024-01-15',  -- CERTIFICATIONDATE
    0,  -- ONGOING_RATE_MONTH (0 = Initial)
    1,  -- INITIAL_DECISIONS_FACILITIES
    0,  -- INITIAL_DECISIONS_HOME_HEALTH
    0,  -- INITIAL_DECISIONS_ALL_OTHER
    0,  -- ONGOING_ALL_FACILITIES
    0,  -- ONGOING_HOME_HEALTH
    0,  -- ALL_OTHER
    0,  -- RETRO_ALL_FACILITIES
    0,  -- RETRO_HOME_HEALTH
    0,  -- RETRO_ALL_OTHER
    0,  -- RETRO_MONTHS
    5001,  -- RFB_ID
    '2023-12-10',  -- RFB_ENTERED_DT
    '2023-12-15',  -- RFB_CLAIM_FORM_RCPT_DT
    '2024-01-15',  -- INITIAL_APPROVAL_DT
    '2023-12-05',  -- RFB_INITIAL_INQUIRY_DT
    '2023-12-20',  -- RFB_CLAIM_PACKET_SENT_DT
    '2023-12-15',  -- RFB_STATISTICAL_START_DT
    '2024-01-15',  -- RFB_STATISTICAL_END_DT
    31,  -- RFB_PROCESS_TO_DECISION_TAT (days)
    'RFB-2023-5001',  -- RFB_REFERENCE
    10,  -- INITIAL_TO_PACKET_TAT
    '2023-12-01',  -- CLAIM_INCURRED_DT
    NULL,  -- CLAIM_EXPIRATION_DT
    6001,  -- EPISODE_OF_BENEFIT_ID
    '2023-12-15',  -- EB_CREATION_DT
    '2024-01-15',  -- FIRSTEBDECISIONDT
    NULL,  -- EB_REASSESSMENT_DT
    3,  -- TOTAL_ELIGIBLE_PROVIDER_COUNT
    0,  -- PENDING_PROVIDER_COUNT
    1,  -- INELIGIBLE_PROVIDER_COUNT
    0,  -- INFORMAL_PROVIDER_COUNT
    7001,  -- POC_PROVIDER_ID
    '2024-01-01',  -- PPSD_START_DT
    '2024-03-31',  -- PPSD_END_DT
    'Nursing Facility',  -- POC_PROVIDER_TYPE_DESC
    31,  -- EOB_CREATION_TO_DECISION_TAT
    'IL',  -- LIFE_STATE
    'IL',  -- ISSUE_STATE
    'IL',  -- POLICY_RESIDENCE_STATE
    '2024-10-31',  -- SNAPSHOT_DATE
    '2024-10-31 08:00:00.000',  -- LOAD_DATE
    'Acme Insurance Co',  -- CARRIER_NAME
    1,  -- CLAIM_TYPE_CD
    1, 0, 0, 0, 0, 0, 0, 0, 0,  -- Various decision flags
    1  -- IS_INITIAL_DECISION_FLAG
);

INSERT INTO CLAIMS_TPA_FEE_WORKSHEET_SNAPSHOT_FACT VALUES (
    'CLM-WS-002', 'POL-DIM-002', 'Mary Johnson', 'POL-100002',
    'Approved', '2024-04-01', '2024-06-30', '2024-05-20',
    1,  -- ONGOING_RATE_MONTH (1 = Ongoing)
    0, 0, 0, 0, 1, 0, 0, 0, 0,
    2,  -- RETRO_MONTHS (Retro claim!)
    5002, '2024-03-15', '2024-03-20', '2024-04-01', '2024-03-10',
    '2024-03-25', '2024-03-20', '2024-05-20', 61,
    'RFB-2024-5002', 15, '2024-03-01', NULL,
    6002, '2024-03-20', '2024-05-20', NULL,
    2, 0, 0, 1, 7002, '2024-04-01', '2024-06-30',
    'Home Health Care', 61, 'TX', 'TX', 'TX',
    '2024-10-31', '2024-10-31 08:00:00.000', 'Beta Health Insurance',
    2, 0, 1, 0, 0, 0, 0, 0, 0, 0,
    0  -- IS_INITIAL_DECISION_FLAG (Ongoing)
);

INSERT INTO CLAIMS_TPA_FEE_WORKSHEET_SNAPSHOT_FACT VALUES (
    'CLM-WS-003', 'POL-DIM-005', 'Robert Williams', 'POL-100005',
    'Denied', '2024-07-01', '2024-09-30', '2024-08-15',
    0,  -- ONGOING_RATE_MONTH (0 = Initial)
    0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
    5003, '2024-06-20', '2024-06-25', NULL, '2024-06-15',
    '2024-07-01', '2024-06-25', '2024-08-15', 51,
    'RFB-2024-5003', 11, '2024-06-10', NULL,
    6003, '2024-06-25', '2024-08-15', NULL,
    1, 1, 2, 0, 7003, '2024-07-01', '2024-09-30',
    'Adult Day Care', 51, 'CA', 'CA', 'CA',
    '2024-10-31', '2024-10-31 08:00:00.000', 'Acme Insurance Co',
    3, 0, 0, 1, 0, 0, 0, 0, 0, 0,
    1  -- IS_INITIAL_DECISION_FLAG
);

INSERT INTO CLAIMS_TPA_FEE_WORKSHEET_SNAPSHOT_FACT VALUES (
    'CLM-WS-004', 'POL-DIM-003', 'Patricia Brown', 'POL-100003',
    'In Assessment', '2024-09-01', '2024-11-30', NULL,
    0,  -- ONGOING_RATE_MONTH (0 = Initial)
    1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    5004, '2024-08-25', '2024-08-30', NULL, '2024-08-20',
    '2024-09-05', '2024-08-30', NULL, NULL,
    'RFB-2024-5004', 10, '2024-08-15', NULL,
    6004, '2024-08-30', NULL, NULL,
    2, 2, 0, 0, 7004, '2024-09-01', '2024-11-30',
    'Skilled Nursing Facility', NULL, 'WA', 'WA', 'WA',
    '2024-10-31', '2024-10-31 08:00:00.000', 'Acme Insurance Co',
    1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    0  -- IS_INITIAL_DECISION_FLAG (In Assessment)
);

-- Verify data insertion
SELECT 'Sample data inserted successfully' AS status;
SELECT COUNT(*) AS policy_count FROM POLICY_MONTHLY_SNAPSHOT_FACT;
SELECT COUNT(*) AS claims_count FROM CLAIMS_TPA_FEE_WORKSHEET_SNAPSHOT_FACT;

